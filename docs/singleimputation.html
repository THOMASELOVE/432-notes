<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Science for Biological, Medical and Health Research - 7&nbsp; Dealing with Missingness: Single Imputation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./datasummaries.html" rel="next">
<link href="./smart.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Dealing with Missingness: Single Imputation</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science for Biological, Medical and Health Research</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./incomplete.html" class="sidebar-item-text sidebar-link">This is work in progress</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">R Setup</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nhanes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Building the <code>nh432</code> example</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nh432cb.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Codebook for <code>nh432</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./431review1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">431 Review: Comparing Means</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./431review2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">431 Review: Comparing Rates</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./431review3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">431 Review: Fitting Linear Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./smart.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">BRFSS SMART Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./singleimputation.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Dealing with Missingness: Single Imputation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasummaries.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Summarizing <code>smart_cle1</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anovasmart.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Analysis of Variance with SMART</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anovaexamples.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Two-Way ANOVA and Interaction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ancova_emphysema.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Analysis of Covariance</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ancova_smart.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Analysis of Covariance with the SMART data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonlinearity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Adding Non-linear Terms to a Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./olsfitting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Using <code>ols</code> to fit linear models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prostate1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">A Model for Prostate Cancer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prostate2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Validating our Prostate Cancer Model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple_imp.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multiple Imputation and Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tableone.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Building Table 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Logistic Regression: The Foundations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Logistic Regression with <code>glm</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Logistic Regression with <code>lrm</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./effectsize.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Estimating and Interpreting Effect Sizes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./binaryregression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Colorectal Cancer Screening and Some Special Cases</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Modeling a Count Outcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Negative Binomial Models for Count Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Zero-Inflated Models for Count Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ordinaloutcome.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Modeling an Ordinal Categorical Outcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multinomial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Multinomial Logistic Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Time To Event / Survival Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cox1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Cox Regression Models, Part 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cox2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Cox Regression Models, Part 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#r-setup-used-here" id="toc-r-setup-used-here" class="nav-link active" data-scroll-target="#r-setup-used-here"><span class="toc-section-number">7.1</span>  R Setup Used Here</a>
  <ul class="collapse">
  <li><a href="#data-load" id="toc-data-load" class="nav-link" data-scroll-target="#data-load"><span class="toc-section-number">7.1.1</span>  Data Load</a></li>
  </ul></li>
  <li><a href="#selecting-some-variables-from-the-smart_cle-data" id="toc-selecting-some-variables-from-the-smart_cle-data" class="nav-link" data-scroll-target="#selecting-some-variables-from-the-smart_cle-data"><span class="toc-section-number">7.2</span>  Selecting Some Variables from the <code>smart_cle</code> data</a></li>
  <li><a href="#smart_cle1-seeing-our-missing-data" id="toc-smart_cle1-seeing-our-missing-data" class="nav-link" data-scroll-target="#smart_cle1-seeing-our-missing-data"><span class="toc-section-number">7.3</span>  <code>smart_cle1</code>: Seeing our Missing Data</a>
  <ul class="collapse">
  <li><a href="#plotting-missingness" id="toc-plotting-missingness" class="nav-link" data-scroll-target="#plotting-missingness"><span class="toc-section-number">7.3.1</span>  Plotting Missingness</a></li>
  </ul></li>
  <li><a href="#missing-data-mechanisms" id="toc-missing-data-mechanisms" class="nav-link" data-scroll-target="#missing-data-mechanisms"><span class="toc-section-number">7.4</span>  Missing-data mechanisms</a></li>
  <li><a href="#options-for-dealing-with-missingness" id="toc-options-for-dealing-with-missingness" class="nav-link" data-scroll-target="#options-for-dealing-with-missingness"><span class="toc-section-number">7.5</span>  Options for Dealing with Missingness</a></li>
  <li><a href="#complete-case-and-available-case-analyses" id="toc-complete-case-and-available-case-analyses" class="nav-link" data-scroll-target="#complete-case-and-available-case-analyses"><span class="toc-section-number">7.6</span>  Complete Case (and Available Case) analyses</a></li>
  <li><a href="#single-imputation" id="toc-single-imputation" class="nav-link" data-scroll-target="#single-imputation"><span class="toc-section-number">7.7</span>  Single Imputation</a></li>
  <li><a href="#multiple-imputation" id="toc-multiple-imputation" class="nav-link" data-scroll-target="#multiple-imputation"><span class="toc-section-number">7.8</span>  Multiple Imputation</a></li>
  <li><a href="#approach-1-building-a-complete-case-analysis-smart_cle1_cc" id="toc-approach-1-building-a-complete-case-analysis-smart_cle1_cc" class="nav-link" data-scroll-target="#approach-1-building-a-complete-case-analysis-smart_cle1_cc"><span class="toc-section-number">7.9</span>  Approach 1: Building a Complete Case Analysis: <code>smart_cle1_cc</code></a></li>
  <li><a href="#approach-2-single-imputation-to-create-smart_cle1_sh" id="toc-approach-2-single-imputation-to-create-smart_cle1_sh" class="nav-link" data-scroll-target="#approach-2-single-imputation-to-create-smart_cle1_sh"><span class="toc-section-number">7.10</span>  Approach 2: Single Imputation to create <code>smart_cle1_sh</code></a>
  <ul class="collapse">
  <li><a href="#what-type-of-missingness-do-we-have" id="toc-what-type-of-missingness-do-we-have" class="nav-link" data-scroll-target="#what-type-of-missingness-do-we-have"><span class="toc-section-number">7.10.1</span>  What Type of Missingness Do We Have?</a></li>
  <li><a href="#single-imputation-into-smart_cle1_sh" id="toc-single-imputation-into-smart_cle1_sh" class="nav-link" data-scroll-target="#single-imputation-into-smart_cle1_sh"><span class="toc-section-number">7.10.2</span>  Single imputation into <code>smart_cle1_sh</code></a></li>
  <li><a href="#imputing-binary-categorical-variables" id="toc-imputing-binary-categorical-variables" class="nav-link" data-scroll-target="#imputing-binary-categorical-variables"><span class="toc-section-number">7.10.3</span>  Imputing Binary Categorical Variables</a></li>
  <li><a href="#imputing-quantitative-variables" id="toc-imputing-quantitative-variables" class="nav-link" data-scroll-target="#imputing-quantitative-variables"><span class="toc-section-number">7.10.4</span>  Imputing Quantitative Variables</a></li>
  <li><a href="#imputation-results" id="toc-imputation-results" class="nav-link" data-scroll-target="#imputation-results"><span class="toc-section-number">7.10.5</span>  Imputation Results</a></li>
  <li><a href="#imputing-multi-categorical-variables" id="toc-imputing-multi-categorical-variables" class="nav-link" data-scroll-target="#imputing-multi-categorical-variables"><span class="toc-section-number">7.10.6</span>  Imputing Multi-Categorical Variables</a></li>
  <li><a href="#saving-the-new-tibbles" id="toc-saving-the-new-tibbles" class="nav-link" data-scroll-target="#saving-the-new-tibbles"><span class="toc-section-number">7.10.7</span>  Saving the new tibbles</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-single-imp" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Dealing with Missingness: Single Imputation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="r-setup-used-here" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="r-setup-used-here"><span class="header-section-number">7.1</span> R Setup Used Here</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="cn">NA</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(simputation)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visdat)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-load" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="data-load"><span class="header-section-number">7.1.1</span> Data Load</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>smart_cle <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/smart_cle.Rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="selecting-some-variables-from-the-smart_cle-data" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="selecting-some-variables-from-the-smart_cle-data"><span class="header-section-number">7.2</span> Selecting Some Variables from the <code>smart_cle</code> data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>smart_cle1 <span class="ot">&lt;-</span> smart_cle <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SEQNO, physhealth, genhealth, bmi, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>         age_imp, female, race_eth, internet30, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>         smoke100, activity, drinks_wk, veg_day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>smart_cle.Rds</code> data file available on the Data and Code page of <a href="https://github.com/THOMASELOVE/2020-432">our website</a> describes information on 99 variables for 1133 respondents to the BRFSS 2017, who live in the Cleveland-Elyria, OH, Metropolitan Statistical Area. The variables in the <code>smart_cle1.csv</code> file are listed below, along with the items that generate these responses.</p>
<table class="table">
<colgroup>
<col style="width: 15%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>SEQNO</code></td>
<td>respondent identification number (all begin with 2016)</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>physhealth</code></td>
<td>Now thinking about your physical health, which includes physical illness and injury, for how many days during the past 30 days was your physical health not good?</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>genhealth</code></td>
<td>Would you say that in general, your health is … (five categories: Excellent, Very Good, Good, Fair or Poor)</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>bmi</code></td>
<td>Body mass index, in kg/m<sup>2</sup></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>age_imp</code></td>
<td>Age, imputed, in years</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>female</code></td>
<td>Sex, 1 = female, 0 = male</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>race_eth</code></td>
<td>Race and Ethnicity, in five categories</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>internet30</code></td>
<td>Have you used the internet in the past 30 days? (1 = yes, 0 = no)</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>smoke100</code></td>
<td>Have you smoked at least 100 cigarettes in your life? (1 = yes, 0 = no)</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>activity</code></td>
<td>Physical activity (Highly Active, Active, Insufficiently Active, Inactive)</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>drinks_wk</code></td>
<td>On average, how many drinks of alcohol do you consume in a week?</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>veg_day</code></td>
<td>How many servings of vegetables do you consume per day, on average?</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(smart_cle1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [1,133 × 12] (S3: tbl_df/tbl/data.frame)
 $ SEQNO     : num [1:1133] 2.02e+09 2.02e+09 2.02e+09 2.02e+09 2.02e+09 ...
 $ physhealth: num [1:1133] 4 0 0 0 0 2 2 0 0 0 ...
 $ genhealth : Factor w/ 5 levels "1_Excellent",..: 1 1 3 3 3 2 3 2 4 1 ...
 $ bmi       : num [1:1133] NA 23.1 26.9 26.5 24.2 ...
 $ age_imp   : num [1:1133] 51 28 37 36 88 43 23 34 58 54 ...
 $ female    : num [1:1133] 1 1 1 1 0 0 0 0 0 1 ...
 $ race_eth  : Factor w/ 5 levels "White non-Hispanic",..: 1 1 3 1 1 1 1 3 2 1 ...
 $ internet30: num [1:1133] 1 1 0 1 1 1 1 1 1 1 ...
 $ smoke100  : num [1:1133] 1 0 0 1 1 1 0 0 0 1 ...
 $ activity  : Factor w/ 4 levels "Highly_Active",..: 4 4 3 1 1 NA 1 1 1 1 ...
 $ drinks_wk : num [1:1133] 0.7 0 0 4.67 0.93 0 2 0 0 0.47 ...
 $ veg_day   : num [1:1133] NA 3 4.06 2.07 1.31 NA 1.57 0.83 0.49 1.72 ...</code></pre>
</div>
</div>
</section>
<section id="smart_cle1-seeing-our-missing-data" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="smart_cle1-seeing-our-missing-data"><span class="header-section-number">7.3</span> <code>smart_cle1</code>: Seeing our Missing Data</h2>
<p>The <code>naniar</code> package provides several useful functions for summarizing missingness in our data set. Like all tidy data sets, our <code>smart_cle1</code> tibble contains rows which describe observations, sometimes called <em>cases</em>, and also contains columns which describe variables.</p>
<p>Overall, there are 1133 cases, and 1133 observations in our <code>smart_cle1</code> tibble.</p>
<ul>
<li>We can obtain a count of the number of missing cells in the entire tibble.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>smart_cle1 <span class="sc">|&gt;</span> <span class="fu">n_miss</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 479</code></pre>
</div>
</div>
<ul>
<li>We can use the <code>miss_var_summary</code> function to get a sorted table of each variable by number missing.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(smart_cle1) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">variable</th>
<th style="text-align: right;">n_miss</th>
<th style="text-align: right;">pct_miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">activity</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">9.6204766</td>
</tr>
<tr class="even">
<td style="text-align: left;">veg_day</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">8.9143866</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bmi</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">8.0317741</td>
</tr>
<tr class="even">
<td style="text-align: left;">drinks_wk</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">5.8252427</td>
</tr>
<tr class="odd">
<td style="text-align: left;">smoke100</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3.5304501</td>
</tr>
<tr class="even">
<td style="text-align: left;">race_eth</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">2.2947926</td>
</tr>
<tr class="odd">
<td style="text-align: left;">physhealth</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2.1182701</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_imp</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.9708738</td>
</tr>
<tr class="odd">
<td style="text-align: left;">internet30</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.6178288</td>
</tr>
<tr class="even">
<td style="text-align: left;">genhealth</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.3530450</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SEQNO</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Or we can use the <code>miss_var_table</code> function to tabulate the number of variables that have each observed level of missingness.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_table</span>(smart_cle1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
   n_miss_in_var n_vars pct_vars
           &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1             0      2    16.7 
 2             4      1     8.33
 3             7      1     8.33
 4            11      1     8.33
 5            24      1     8.33
 6            26      1     8.33
 7            40      1     8.33
 8            66      1     8.33
 9            91      1     8.33
10           101      1     8.33
11           109      1     8.33</code></pre>
</div>
</div>
<ul>
<li>Or we can get a count for a specific variable, like <code>activity</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>smart_cle1 <span class="sc">|&gt;</span> <span class="fu">select</span>(activity) <span class="sc">|&gt;</span> <span class="fu">n_miss</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 109</code></pre>
</div>
</div>
<ul>
<li>We can also use <code>prop_miss_case</code> or <code>pct_miss_case</code> to specify the proportion (or percentage) of missing observations across an entire data set, or within a specific variable.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop_miss_case</span>(smart_cle1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2127096</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>smart_cle1 <span class="sc">|&gt;</span> <span class="fu">select</span>(activity) <span class="sc">|&gt;</span> <span class="fu">pct_miss_case</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.620477</code></pre>
</div>
</div>
<ul>
<li>We can also use <code>prop_miss_var</code> or <code>pct_miss_var</code> to specify the proportion (or percentage) of variables with missing observations across an entire data set.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop_miss_var</span>(smart_cle1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pct_miss_var</span>(smart_cle1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 83.33333</code></pre>
</div>
</div>
<ul>
<li>We use <code>miss_case_table</code> to identify the number of missing values for each of the cases (rows) in our tibble.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_case_table</span>(smart_cle1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  n_miss_in_case n_cases pct_cases
           &lt;int&gt;   &lt;int&gt;     &lt;dbl&gt;
1              0     892    78.7  
2              1     129    11.4  
3              2      51     4.50 
4              3      22     1.94 
5              4      21     1.85 
6              5      10     0.883
7              6       8     0.706</code></pre>
</div>
</div>
<ul>
<li>Use <code>miss_case_summary</code> to specify individual observations and count their missing values.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_case_summary</span>(smart_cle1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,133 × 3
    case n_miss pct_miss
   &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1    17      6     50  
 2    42      6     50  
 3   254      6     50  
 4   425      6     50  
 5   521      6     50  
 6   729      6     50  
 7   757      6     50  
 8  1051      6     50  
 9    89      5     41.7
10    94      5     41.7
# … with 1,123 more rows</code></pre>
</div>
</div>
<p>The case numbers identified here are row numbers. Extract the data for case 17, for instance, with the <code>slice</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>smart_cle1 <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">17</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
      SEQNO physh…¹ genhe…²   bmi age_imp female race_…³ inter…⁴ smoke…⁵ activ…⁶
      &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;  
1    2.02e9       0 1_Exce…    NA      50      0 White …      NA      NA &lt;NA&gt;   
# … with 2 more variables: drinks_wk &lt;dbl&gt;, veg_day &lt;dbl&gt;, and abbreviated
#   variable names ¹​physhealth, ²​genhealth, ³​race_eth, ⁴​internet30, ⁵​smoke100,
#   ⁶​activity</code></pre>
</div>
</div>
<section id="plotting-missingness" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="plotting-missingness"><span class="header-section-number">7.3.1</span> Plotting Missingness</h3>
<p>The <code>gg_miss_var</code> function plots the number of missing observations in each variable in our data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(smart_cle1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="singleimputation_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So the most commonly missing variable is <code>activity</code>.</p>
<p>To get a general sense of the missingness in our data, we might use either the <code>vis_dat</code> or the <code>vis_miss</code> function from the <code>visdat</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(smart_cle1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="singleimputation_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_dat</span>(smart_cle1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="singleimputation_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="missing-data-mechanisms" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="missing-data-mechanisms"><span class="header-section-number">7.4</span> Missing-data mechanisms</h2>
<p>My source for this description of mechanisms is Chapter 25 of <span class="citation" data-cites="GelmanHill2007">Gelman and Hill (<a href="references.html#ref-GelmanHill2007" role="doc-biblioref">2007</a>)</span>, and that chapter is <a href="http://www.stat.columbia.edu/~gelman/arm/missing.pdf">available at this link</a>.</p>
<ol type="1">
<li><strong>MCAR = Missingness completely at random</strong>. A variable is missing completely at random if the probability of missingness is the same for all units, for example, if for each subject, we decide whether to collect the <code>diabetes</code> status by rolling a die and refusing to answer if a “6” shows up. If data are missing completely at random, then throwing out cases with missing data does not bias your inferences.</li>
<li><strong>Missingness that depends only on observed predictors</strong>. A more general assumption, called <strong>missing at random</strong> or <strong>MAR</strong>, is that the probability a variable is missing depends only on available information. Here, we would have to be willing to assume that the probability of nonresponse to <code>diabetes</code> depends only on the other, fully recorded variables in the data. It is often reasonable to model this process as a logistic regression, where the outcome variable equals 1 for observed cases and 0 for missing. When an outcome variable is missing at random, it is acceptable to exclude the missing cases (that is, to treat them as NA), as long as the regression controls for all the variables that affect the probability of missingness.</li>
<li><strong>Missingness that depends on unobserved predictors</strong>. Missingness is no longer “at random” if it depends on information that has not been recorded and this information also predicts the missing values. If a particular treatment causes discomfort, a patient is more likely to drop out of the study. This missingness is not at random (unless “discomfort” is measured and observed for all patients). If missingness is not at random, it must be explicitly modeled, or else you must accept some bias in your inferences.</li>
<li><strong>Missingness that depends on the missing value itself.</strong> Finally, a particularly difficult situation arises when the probability of missingness depends on the (potentially missing) variable itself. For example, suppose that people with higher earnings are less likely to reveal them.</li>
</ol>
<p>Essentially, situations 3 and 4 are referred to collectively as <strong>non-random missingness</strong>, and cause more trouble for us than 1 and 2.</p>
</section>
<section id="options-for-dealing-with-missingness" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="options-for-dealing-with-missingness"><span class="header-section-number">7.5</span> Options for Dealing with Missingness</h2>
<p>There are several available methods for dealing with missing data that are MCAR or MAR, but they basically boil down to:</p>
<ul>
<li>Complete Case (or Available Case) analyses</li>
<li>Single Imputation</li>
<li>Multiple Imputation</li>
</ul>
</section>
<section id="complete-case-and-available-case-analyses" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="complete-case-and-available-case-analyses"><span class="header-section-number">7.6</span> Complete Case (and Available Case) analyses</h2>
<p>In <strong>Complete Case</strong> analyses, rows containing NA values are omitted from the data before analyses commence. This is the default approach for many statistical software packages, and may introduce unpredictable bias and fail to include some useful, often hard-won information.</p>
<ul>
<li>A complete case analysis can be appropriate when the number of missing observations is not large, and the missing pattern is either MCAR (missing completely at random) or MAR (missing at random.)</li>
<li>Two problems arise with complete-case analysis:
<ol type="1">
<li>If the units with missing values differ systematically from the completely observed cases, this could bias the complete-case analysis.</li>
<li>If many variables are included in a model, there may be very few complete cases, so that most of the data would be discarded for the sake of a straightforward analysis.</li>
</ol></li>
<li>A related approach is <em>available-case</em> analysis where different aspects of a problem are studied with different subsets of the data, perhaps identified on the basis of what is missing in them.</li>
</ul>
</section>
<section id="single-imputation" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="single-imputation"><span class="header-section-number">7.7</span> Single Imputation</h2>
<p>In <strong>single imputation</strong> analyses, NA values are estimated/replaced <em>one time</em> with <em>one particular data value</em> for the purpose of obtaining more complete samples, at the expense of creating some potential bias in the eventual conclusions or obtaining slightly <em>less</em> accurate estimates than would be available if there were no missing values in the data.</p>
<ul>
<li>A single imputation can be just a replacement with the mean or median (for a quantity) or the mode (for a categorical variable.) However, such an approach, though easy to understand, underestimates variance and ignores the relationship of missing values to other variables.</li>
<li>Single imputation can also be done using a variety of models to try to capture information about the NA values that are available in other variables within the data set.</li>
<li>The <code>simputation</code> package can help us execute single imputations using a wide variety of techniques, within the pipe approach used by the <code>tidyverse</code>. Another approach I have used in the past is the <code>mice</code> package, which can also perform single imputations.</li>
</ul>
</section>
<section id="multiple-imputation" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="multiple-imputation"><span class="header-section-number">7.8</span> Multiple Imputation</h2>
<p><strong>Multiple imputation</strong>, where NA values are repeatedly estimated/replaced with multiple data values, for the purpose of obtaining mode complete samples <em>and</em> capturing details of the variation inherent in the fact that the data have missingness, so as to obtain <em>more</em> accurate estimates than are possible with single imputation.</p>
<ul>
<li>We’ll postpone the discussion of multiple imputation for a while.</li>
</ul>
</section>
<section id="approach-1-building-a-complete-case-analysis-smart_cle1_cc" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="approach-1-building-a-complete-case-analysis-smart_cle1_cc"><span class="header-section-number">7.9</span> Approach 1: Building a Complete Case Analysis: <code>smart_cle1_cc</code></h2>
<p>In the 431 course, we usually dealt with missing data by restricting our analyses to respondents with complete data on all variables. Let’s start by doing that here. We’ll create a new tibble called <code>smart_cle1_cc</code> which includes all respondents with complete data on all of these variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>smart_cle1_cc <span class="ot">&lt;-</span> smart_cle1 <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(smart_cle1_cc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 892  12</code></pre>
</div>
</div>
<p>Our <code>smart_cle1_cc</code> tibble now has many fewer observations than its predecessors, but all of the variables in this complete cases tibble have no missing observations.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">Data Set</th>
<th style="text-align: right;">Rows</th>
<th style="text-align: right;">Columns</th>
<th style="text-align: right;">Missingness?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>smart_cle</code></td>
<td style="text-align: right;">1133</td>
<td style="text-align: right;">99</td>
<td style="text-align: right;">Quite a bit.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>smart_cle1</code></td>
<td style="text-align: right;">1133</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">Quite a bit.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>smart_cle1_cc</code></td>
<td style="text-align: right;">892</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">None.</td>
</tr>
</tbody>
</table>
</section>
<section id="approach-2-single-imputation-to-create-smart_cle1_sh" class="level2" data-number="7.10">
<h2 data-number="7.10" class="anchored" data-anchor-id="approach-2-single-imputation-to-create-smart_cle1_sh"><span class="header-section-number">7.10</span> Approach 2: Single Imputation to create <code>smart_cle1_sh</code></h2>
<p>Next, we’ll create a data set which has all of the rows in the original <code>smart_cle1</code> tibble, but deals with missingness by imputing (estimating / filling in) new values for each of the missing values. To do this, we’ll make heavy use of the <code>simputation</code> package in R.</p>
<p>The <code>simputation</code> package is designed for single imputation work. Note that we’ll eventually adopt a <strong>multiple imputation</strong> strategy in some of our modeling work, and we’ll use some specialized tools to facilitate that later.</p>
<p>To begin, we’ll create a “shadow” in our tibble to track what we’ll need to impute.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="ot">&lt;-</span> <span class="fu">bind_shadow</span>(smart_cle1)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(smart_cle1_sh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "SEQNO"         "physhealth"    "genhealth"     "bmi"          
 [5] "age_imp"       "female"        "race_eth"      "internet30"   
 [9] "smoke100"      "activity"      "drinks_wk"     "veg_day"      
[13] "SEQNO_NA"      "physhealth_NA" "genhealth_NA"  "bmi_NA"       
[17] "age_imp_NA"    "female_NA"     "race_eth_NA"   "internet30_NA"
[21] "smoke100_NA"   "activity_NA"   "drinks_wk_NA"  "veg_day_NA"   </code></pre>
</div>
</div>
<p>Note that the <code>bind_shadow()</code> function doubles the number of variables in our tibble, specifically by creating a new variable for each that takes the value <code>!NA</code> or <code>NA</code>. For example, consider</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="sc">|&gt;</span> <span class="fu">count</span>(activity, activity_NA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  activity              activity_NA     n
  &lt;fct&gt;                 &lt;fct&gt;       &lt;int&gt;
1 Highly_Active         !NA           338
2 Active                !NA           173
3 Insufficiently_Active !NA           201
4 Inactive              !NA           312
5 &lt;NA&gt;                  NA            109</code></pre>
</div>
</div>
<p>The <code>activity_NA</code> variable takes the value <code>!NA</code> (meaning not missing) when the value of the <code>activity</code> variable is known, and takes the value <code>NA</code> for observations where the <code>activity</code> variable is missing. This background tracking will be helpful to us when we try to assess the impact of imputation on some of our summaries.</p>
<section id="what-type-of-missingness-do-we-have" class="level3" data-number="7.10.1">
<h3 data-number="7.10.1" class="anchored" data-anchor-id="what-type-of-missingness-do-we-have"><span class="header-section-number">7.10.1</span> What Type of Missingness Do We Have?</h3>
<p>There are three types of missingness that we might assume in any given setting: missing completely at random (MCAR), missing at random (MAR) and missing not at random (MNAR). Together, MCAR and MAR are sometimes called <em>ignorable</em> non-response, which essentially means that imputation provides a way to useful estimates. MNAR or missing NOT at random is sometimes called non-ignorable missingness, implying that even high-quality imputation may not be sufficient to provide useful information to us.</p>
<p><strong>Missing Completely at Random</strong> means that the missing data points are a random subset of the data. Essentially, there is nothing that makes some data more likely to be missing than others. If the data truly match the standard for MCAR, then a complete-case analysis will be about as good as an analysis after single or multiple imputation.</p>
<p><strong>Missing at Random</strong> means that there is a systematic relationship between the observed data and the missingness mechanism. Another way to say this is that the missing value is not related to the reason why it is missing, but is related to the other variables collected in the study. The implication is that the missingness can be accounted for by studying the variables with complete information. Imputation strategies can be very helpful here, incorporating what we know (or think we know) about the relationships between the results that are missing and the results that we see.</p>
<ul>
<li>Wikipedia provides a nice example. If men are less likely to fill in a depression survey, but this has nothing to do with their level of depression after accounting for the fact that they are male, then the missingess can be assumed MAR.</li>
<li>Determining whether missingness is MAR or MNAR can be tricky. We’ll spend more time discussing this later.</li>
</ul>
<p><strong>Missing NOT at Random</strong> means that the missing value is related to the reason why it is missing.</p>
<ul>
<li><p>Continuing the Wikipedia example, if men failed to fill in a depression survey because of their level of depression, then this would be MNAR.</p></li>
<li><p>Single imputation is most helpful in the MAR situation, although it is also appropriate when we assume MCAR.</p></li>
<li><p>Multiple imputation will, similarly, be more helpful in MCAR and MAR situations than when data are missing NOT at random.</p></li>
</ul>
<p>It’s worth noting that many people are unwilling to impute values for outcomes or key predictors in a modeling setting, but are happy to impute for less important covariates. For now, we’ll assume MCAR or MAR for all of the missingness in our <code>smart_cle1</code> data, which will allow us to adopt a single imputation strategy.</p>
</section>
<section id="single-imputation-into-smart_cle1_sh" class="level3" data-number="7.10.2">
<h3 data-number="7.10.2" class="anchored" data-anchor-id="single-imputation-into-smart_cle1_sh"><span class="header-section-number">7.10.2</span> Single imputation into <code>smart_cle1_sh</code></h3>
<p>Which variables in <code>smart_cle1_sh</code> contain missing data?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(smart_cle1_sh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 3
   variable   n_miss pct_miss
   &lt;chr&gt;       &lt;int&gt;    &lt;dbl&gt;
 1 activity      109    9.62 
 2 veg_day       101    8.91 
 3 bmi            91    8.03 
 4 drinks_wk      66    5.83 
 5 smoke100       40    3.53 
 6 race_eth       26    2.29 
 7 physhealth     24    2.12 
 8 age_imp        11    0.971
 9 internet30      7    0.618
10 genhealth       4    0.353
# … with 14 more rows</code></pre>
</div>
</div>
<p>We will impute these variables using several different strategies, all supported nicely by the <code>simputation</code> package.</p>
<p>These include imputation methods based solely on the distribution of the complete cases of the variable being imputed.</p>
<ul>
<li><code>impute_median</code>: impute the median value of all non-missing observations into the missing values for the variable</li>
<li><code>impute_rhd</code>: random “hot deck” imputation involves drawing at random from the complete cases for that variable</li>
</ul>
<p>Also available are imputation strategies that impute predicted values from models using other variables in the data set besides the one being imputed.</p>
<ul>
<li><code>impute_pmm</code>: imputation using predictive mean matching</li>
<li><code>impute_rlm</code>: imputation using robust linear models</li>
<li><code>impute_cart</code>: imputation using classification and regression trees</li>
<li><code>impute_knn</code>: imputation using k-nearest neighbors methods</li>
</ul>
</section>
<section id="imputing-binary-categorical-variables" class="level3" data-number="7.10.3">
<h3 data-number="7.10.3" class="anchored" data-anchor-id="imputing-binary-categorical-variables"><span class="header-section-number">7.10.3</span> Imputing Binary Categorical Variables</h3>
<p>Here, we’ll arbitrarily impute our 1/0 variables as follows:</p>
<ul>
<li>For <code>internet30</code> we’ll use the <code>impute_rhd</code> approach to draw a random observation from the existing set of 1s and 0s in the complete <code>internet30</code> data.</li>
<li>For <code>smoke100</code> we’ll use a method called predictive mean matching (<code>impute_pmm</code>) which takes the result from a model based on the (imputed) <code>internet30</code> value and whether or not the subject is <code>female</code>, and converts it to the nearest value in the observed <code>smoke100</code> data. This is a good approach for imputing discrete variables.</li>
</ul>
<p>These are completely arbitrary choices, for demonstration purposes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2020001</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="ot">&lt;-</span> smart_cle1_sh <span class="sc">|&gt;</span> <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">impute_rhd</span>(internet30 <span class="sc">~</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">impute_pmm</span>(smoke100 <span class="sc">~</span> internet30 <span class="sc">+</span> female) <span class="sc">|&gt;</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="sc">|&gt;</span> <span class="fu">count</span>(smoke100, smoke100_NA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  smoke100 smoke100_NA     n
     &lt;dbl&gt; &lt;fct&gt;       &lt;int&gt;
1        0 !NA           579
2        0 NA             21
3        1 !NA           514
4        1 NA             19</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="sc">|&gt;</span> <span class="fu">count</span>(internet30, internet30_NA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  internet30 internet30_NA     n
       &lt;dbl&gt; &lt;fct&gt;         &lt;int&gt;
1          0 !NA             207
2          0 NA                1
3          1 !NA             919
4          1 NA                6</code></pre>
</div>
</div>
<p>Other approaches that may be used with 1/0 variables include <code>impute_knn</code> and <code>impute_pmm</code>.</p>
</section>
<section id="imputing-quantitative-variables" class="level3" data-number="7.10.4">
<h3 data-number="7.10.4" class="anchored" data-anchor-id="imputing-quantitative-variables"><span class="header-section-number">7.10.4</span> Imputing Quantitative Variables</h3>
<p>We’ll demonstrate a different approach for imputing each of the quantitative variables with missing observations. Again, we’re making purely arbitrary decisions here about what to include in each imputation. In practical work, we’d want to be a bit more thoughtful about this.</p>
<p>Note that I’m choosing to use <code>impute_pmm</code> with the <code>physhealth</code> and <code>age_imp</code> variables. This is (in part) because I want my imputations to be integers, as the other observations are for those variables. <code>impute_rhd</code> would also accomplish this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2020001</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="ot">&lt;-</span> smart_cle1_sh <span class="sc">|&gt;</span> <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">impute_rhd</span>(veg_day <span class="sc">~</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">impute_median</span>(drinks_wk <span class="sc">~</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">impute_pmm</span>(physhealth <span class="sc">~</span> drinks_wk <span class="sc">+</span> female <span class="sc">+</span> smoke100) <span class="sc">|&gt;</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">impute_pmm</span>(age_imp <span class="sc">~</span> drinks_wk <span class="sc">+</span> physhealth) <span class="sc">|&gt;</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">impute_rlm</span>(bmi <span class="sc">~</span> physhealth <span class="sc">+</span> smoke100) <span class="sc">|&gt;</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="imputation-results" class="level3" data-number="7.10.5">
<h3 data-number="7.10.5" class="anchored" data-anchor-id="imputation-results"><span class="header-section-number">7.10.5</span> Imputation Results</h3>
<p>Let’s plot a few of these results, so we can see what imputation has done to the distribution of these quantities.</p>
<ol type="1">
<li><code>veg_day</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(smart_cle1_sh, <span class="fu">aes</span>(<span class="at">x =</span> veg_day_NA, <span class="at">y =</span> veg_day)) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_count</span>() <span class="sc">+</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Imputation Results for veg_day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="singleimputation_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">favstats</span>(veg_day <span class="sc">~</span> veg_day_NA, <span class="at">data =</span> smart_cle1_sh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  veg_day_NA  min     Q1 median   Q3  max     mean       sd    n missing
1        !NA 0.00 1.2675   1.72 2.42 7.49 1.912548 1.038403 1032       0
2         NA 0.26 1.3400   1.86 2.72 5.97 2.085050 1.062316  101       0</code></pre>
</div>
</div>
<ol start="2" type="1">
<li><code>drinks_wk</code> for which we imputed the median value…</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(smart_cle1_sh, <span class="fu">aes</span>(<span class="at">x =</span> drinks_wk_NA, <span class="at">y =</span> drinks_wk)) <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_count</span>() <span class="sc">+</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Imputation Results for drinks_wk"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="singleimputation_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="sc">|&gt;</span> <span class="fu">filter</span>(drinks_wk_NA <span class="sc">==</span> <span class="st">"NA"</span>) <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(drinks_wk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> drinks_wk  n percent
      0.23 66       1</code></pre>
</div>
</div>
<ol start="3" type="1">
<li><code>physhealth</code>, a count between 0 and 30…</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(smart_cle1_sh, </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> physhealth, <span class="at">y =</span> physhealth_NA)) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>() <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Imputation Results for physhealth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.426</code></pre>
</div>
<div class="cell-output-display">
<p><img src="singleimputation_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="sc">|&gt;</span> <span class="fu">filter</span>(physhealth_NA <span class="sc">==</span> <span class="st">"NA"</span>) <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(physhealth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> physhealth  n    percent
          3  1 0.04166667
          4  2 0.08333333
          5 13 0.54166667
          6  8 0.33333333</code></pre>
</div>
</div>
<ol start="4" type="1">
<li><code>age_imp</code>, in (integer) years</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(smart_cle1_sh, </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age_imp, <span class="at">color =</span> age_imp_NA)) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Imputation Results for age_imp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="singleimputation_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="sc">|&gt;</span> <span class="fu">filter</span>(age_imp_NA <span class="sc">==</span> <span class="st">"NA"</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(age_imp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> age_imp n    percent
      48 1 0.09090909
      57 7 0.63636364
      58 1 0.09090909
      61 1 0.09090909
      63 1 0.09090909</code></pre>
</div>
</div>
<ol start="5" type="1">
<li><code>bmi</code> or body mass index</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(smart_cle1_sh, <span class="fu">aes</span>(<span class="at">x =</span> bmi, <span class="at">fill =</span> bmi_NA)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of BMI and imputed BMI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="singleimputation_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">favstats</span>(bmi <span class="sc">~</span> bmi_NA, <span class="at">data =</span> smart_cle1_sh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  bmi_NA     min      Q1   median       Q3      max     mean        sd    n
1    !NA 13.3000 24.1100 27.30000 31.68000 70.56000 28.40947 6.6289286 1042
2     NA 27.0693 27.0693 27.50229 27.66574 30.75898 27.66057 0.8964101   91
  missing
1       0
2       0</code></pre>
</div>
</div>
</section>
<section id="imputing-multi-categorical-variables" class="level3" data-number="7.10.6">
<h3 data-number="7.10.6" class="anchored" data-anchor-id="imputing-multi-categorical-variables"><span class="header-section-number">7.10.6</span> Imputing Multi-Categorical Variables</h3>
<p>The three multi-categorical variables we have left to impute are <code>activity</code>, <code>race_eth</code> and <code>genhealth</code>, and each is presented as a factor in R, rather than as a character variable.</p>
<p>We’ll arbitrarily decide to impute</p>
<ul>
<li><code>activity</code> and <code>genhealth</code> with a classification tree using <code>physhealth</code>, <code>bmi</code> and <code>smoke100</code>,</li>
<li>and then impute <code>race_eth</code> with a random draw from the distribution of complete cases.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2020001</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="ot">&lt;-</span> smart_cle1_sh <span class="sc">|&gt;</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">impute_cart</span>(activity <span class="sc">+</span> genhealth <span class="sc">~</span> physhealth <span class="sc">+</span> bmi <span class="sc">+</span> smoke100) <span class="sc">|&gt;</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">impute_rhd</span>(race_eth <span class="sc">~</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s check our results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="sc">|&gt;</span> <span class="fu">count</span>(activity_NA, activity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  activity_NA activity                  n
  &lt;fct&gt;       &lt;fct&gt;                 &lt;int&gt;
1 !NA         Highly_Active           338
2 !NA         Active                  173
3 !NA         Insufficiently_Active   201
4 !NA         Inactive                312
5 NA          Highly_Active            90
6 NA          Inactive                 19</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="sc">|&gt;</span> <span class="fu">count</span>(race_eth_NA, race_eth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
  race_eth_NA race_eth                     n
  &lt;fct&gt;       &lt;fct&gt;                    &lt;int&gt;
1 !NA         White non-Hispanic         805
2 !NA         Black non-Hispanic         222
3 !NA         Other race non-Hispanic     24
4 !NA         Multiracial non-Hispanic    22
5 !NA         Hispanic                    34
6 NA          White non-Hispanic          19
7 NA          Black non-Hispanic           4
8 NA          Multiracial non-Hispanic     2
9 NA          Hispanic                     1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>smart_cle1_sh <span class="sc">|&gt;</span> <span class="fu">count</span>(genhealth_NA, genhealth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  genhealth_NA genhealth       n
  &lt;fct&gt;        &lt;fct&gt;       &lt;int&gt;
1 !NA          1_Excellent   164
2 !NA          2_VeryGood    383
3 !NA          3_Good        364
4 !NA          4_Fair        158
5 !NA          5_Poor         60
6 NA           2_VeryGood      3
7 NA           3_Good          1</code></pre>
</div>
</div>
<p>And now, we should have no missing values in the data, at all.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_case_table</span>(smart_cle1_sh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  n_miss_in_case n_cases pct_cases
           &lt;int&gt;   &lt;int&gt;     &lt;dbl&gt;
1              0    1133       100</code></pre>
</div>
</div>
</section>
<section id="saving-the-new-tibbles" class="level3" data-number="7.10.7">
<h3 data-number="7.10.7" class="anchored" data-anchor-id="saving-the-new-tibbles"><span class="header-section-number">7.10.7</span> Saving the new tibbles</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(smart_cle1_cc, (<span class="st">"data/smart_cle1_cc.Rds"</span>))</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(smart_cle1_sh, (<span class="st">"data/smart_cle1_sh.Rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-GelmanHill2007" class="csl-entry" role="doc-biblioentry">
Gelman, Andrew, and Jennifer Hill. 2007. <em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>. New York: Cambridge University Press.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./smart.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">BRFSS SMART Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./datasummaries.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Summarizing <code>smart_cle1</code></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>