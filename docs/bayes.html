<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Science for Biological, Medical and Health Research - 33&nbsp; NEW!! Bayes and a Linear Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./bayes2.html" rel="next">
<link href="./lasso.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./bayes.html"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">NEW!! Bayes and a Linear Model</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science for Biological, Medical and Health Research</a> 
        <div class="sidebar-tools-main">
    <a href="./Data-Science-for-Biological,-Medical-and-Health-Research.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./incomplete.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">This is work in progress</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Setup</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nhanes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Building the <code>nh432</code> example</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nh432cb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Codebook for <code>nh432</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./431review1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">431 Review: Comparing Means</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./431review2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">431 Review: Comparing Rates</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./431review3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">431 Review: Fitting Linear Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./smart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">BRFSS SMART Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./singleimputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Dealing with Missingness: Single Imputation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasummaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Summarizing <code>smart_cle1</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anovasmart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Analysis of Variance with SMART</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anovaexamples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Two-Way ANOVA and Interaction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ancova_emphysema.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Analysis of Covariance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ancova_smart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Analysis of Covariance with the SMART data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonlinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Adding Non-linear Terms to a Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./olsfitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Using <code>ols</code> to fit linear models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prostate1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">A Model for Prostate Cancer</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prostate2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Validating our Prostate Cancer Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple_imp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multiple Imputation and Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tableone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Building Table 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Logistic Regression: The Foundations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Logistic Regression with <code>glm</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Logistic Regression with <code>lrm</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./effectsize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Estimating and Interpreting Effect Sizes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./binaryregression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Colorectal Cancer Screening and Some Special Cases</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Modeling a Count Outcome</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Negative Binomial Models for Count Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Zero-Inflated Models for Count Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ordinaloutcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Modeling an Ordinal Categorical Outcome</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Multinomial Logistic Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Time To Event / Survival Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cox1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Cox Regression Models, Part 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cox2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Cox Regression Models, Part 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lasso.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">NEW!! A Few LASSO Ideas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">NEW!! Bayes and a Linear Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">NEW!! Bayes and a Logistic Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#r-setup-used-here" id="toc-r-setup-used-here" class="nav-link active" data-scroll-target="#r-setup-used-here"><span class="header-section-number">33.1</span> R Setup Used Here</a></li>
  <li><a href="#return-to-the-smalldat-example" id="toc-return-to-the-smalldat-example" class="nav-link" data-scroll-target="#return-to-the-smalldat-example"><span class="header-section-number">33.2</span> Return to the <code>smalldat</code> Example</a></li>
  <li><a href="#the-distribution-of-total-cholesterol" id="toc-the-distribution-of-total-cholesterol" class="nav-link" data-scroll-target="#the-distribution-of-total-cholesterol"><span class="header-section-number">33.3</span> The Distribution of Total Cholesterol</a></li>
  <li><a href="#fitting-a-linear-model-with-lm-for-total-cholesterol" id="toc-fitting-a-linear-model-with-lm-for-total-cholesterol" class="nav-link" data-scroll-target="#fitting-a-linear-model-with-lm-for-total-cholesterol"><span class="header-section-number">33.4</span> Fitting a Linear Model with <code>lm()</code> for Total Cholesterol</a></li>
  <li><a href="#fitting-a-bayesian-linear-model" id="toc-fitting-a-bayesian-linear-model" class="nav-link" data-scroll-target="#fitting-a-bayesian-linear-model"><span class="header-section-number">33.5</span> Fitting a Bayesian Linear Model</a>
  <ul class="collapse">
  <li><a href="#extracting-the-posterior" id="toc-extracting-the-posterior" class="nav-link" data-scroll-target="#extracting-the-posterior"><span class="header-section-number">33.5.1</span> Extracting the Posterior</a></li>
  <li><a href="#describing-uncertainty" id="toc-describing-uncertainty" class="nav-link" data-scroll-target="#describing-uncertainty"><span class="header-section-number">33.5.2</span> Describing Uncertainty</a></li>
  <li><a href="#visualizing-the-coefficients-and-credible-intervals" id="toc-visualizing-the-coefficients-and-credible-intervals" class="nav-link" data-scroll-target="#visualizing-the-coefficients-and-credible-intervals"><span class="header-section-number">33.5.3</span> Visualizing the Coefficients and Credible Intervals</a></li>
  </ul></li>
  <li><a href="#summarizing-the-posterior-distribution" id="toc-summarizing-the-posterior-distribution" class="nav-link" data-scroll-target="#summarizing-the-posterior-distribution"><span class="header-section-number">33.6</span> Summarizing the Posterior Distribution</a>
  <ul class="collapse">
  <li><a href="#summarizing-the-parameter-values" id="toc-summarizing-the-parameter-values" class="nav-link" data-scroll-target="#summarizing-the-parameter-values"><span class="header-section-number">33.6.1</span> Summarizing the Parameter values</a></li>
  <li><a href="#probability-of-direction-pd-estimates." id="toc-probability-of-direction-pd-estimates." class="nav-link" data-scroll-target="#probability-of-direction-pd-estimates."><span class="header-section-number">33.6.2</span> Probability of Direction (<code>pd</code>) estimates.</a></li>
  <li><a href="#the-rope-estimates" id="toc-the-rope-estimates" class="nav-link" data-scroll-target="#the-rope-estimates"><span class="header-section-number">33.6.3</span> The ROPE estimates</a></li>
  <li><a href="#convergence-diagnostics" id="toc-convergence-diagnostics" class="nav-link" data-scroll-target="#convergence-diagnostics"><span class="header-section-number">33.6.4</span> Convergence Diagnostics</a></li>
  </ul></li>
  <li><a href="#summarizing-the-priors-used" id="toc-summarizing-the-priors-used" class="nav-link" data-scroll-target="#summarizing-the-priors-used"><span class="header-section-number">33.7</span> Summarizing the Priors Used</a></li>
  <li><a href="#graphical-posterior-predictive-checks" id="toc-graphical-posterior-predictive-checks" class="nav-link" data-scroll-target="#graphical-posterior-predictive-checks"><span class="header-section-number">33.8</span> Graphical Posterior Predictive Checks</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">NEW!! Bayes and a Linear Model</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Almost all of this material is based on</p>
<ul>
<li><a href="https://mc-stan.org/rstanarm/articles/continuous.html" class="uri">https://mc-stan.org/rstanarm/articles/continuous.html</a> and</li>
<li><a href="https://easystats.github.io/bayestestR/articles/bayestestR.html" class="uri">https://easystats.github.io/bayestestR/articles/bayestestR.html</a> and</li>
<li><a href="https://easystats.github.io/bayestestR/articles/example1.html" class="uri">https://easystats.github.io/bayestestR/articles/example1.html</a></li>
</ul>
<p>There’s not a lot that is truly original here. That’s a summer project.</p>
<section id="r-setup-used-here" class="level2" data-number="33.1">
<h2 data-number="33.1" class="anchored" data-anchor-id="r-setup-used-here"><span class="header-section-number">33.1</span> R Setup Used Here</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="cn">NA</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(insight)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(conflicted)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select, dplyr<span class="sc">::</span>filter, base<span class="sc">::</span>mean, base<span class="sc">::</span>range)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="return-to-the-smalldat-example" class="level2" data-number="33.2">
<h2 data-number="33.2" class="anchored" data-anchor-id="return-to-the-smalldat-example"><span class="header-section-number">33.2</span> Return to the <code>smalldat</code> Example</h2>
<p>Consider the <code>smalldat.csv</code> data we discussed in <a href="effectsize.html"><span>Chapter&nbsp;22</span></a>. The data includes 150 observations on 6 variables, and one of our goals was to build a model to predict total cholesterol.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>smalldat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/smalldat.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="table">
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>subject</em></td>
<td>Subject identification code</td>
</tr>
<tr class="even">
<td><em>smoker</em></td>
<td>1 = current smoker, 0 = not current smoker</td>
</tr>
<tr class="odd">
<td><em>totchol</em></td>
<td>total cholesterol, in mg/dl</td>
</tr>
<tr class="even">
<td><em>age</em></td>
<td>age in years</td>
</tr>
<tr class="odd">
<td><em>sex</em></td>
<td>subject’s sex (M or F)</td>
</tr>
<tr class="even">
<td><em>educ</em></td>
<td>subject’s educational attainment (4 levels)</td>
</tr>
</tbody>
</table>
<p>The <em>educ</em> levels are: 1_Low, 2_Middle, 3_High and 4_VHigh, which stands for Very High</p>
</section>
<section id="the-distribution-of-total-cholesterol" class="level2" data-number="33.3">
<h2 data-number="33.3" class="anchored" data-anchor-id="the-distribution-of-total-cholesterol"><span class="header-section-number">33.3</span> The Distribution of Total Cholesterol</h2>
<p>Across the 150 observations in the <code>smalldat</code> data, we have the following summaries of the distribution of total cholesterol, our outcome.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">favstats</span>(<span class="sc">~</span> totchol, <span class="at">data =</span> smalldat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> min     Q1 median     Q3 max   mean       sd   n missing
 150 209.25    237 265.75 332 236.78 38.76809 150       0</code></pre>
</div>
</div>
</section>
<section id="fitting-a-linear-model-with-lm-for-total-cholesterol" class="level2" data-number="33.4">
<h2 data-number="33.4" class="anchored" data-anchor-id="fitting-a-linear-model-with-lm-for-total-cholesterol"><span class="header-section-number">33.4</span> Fitting a Linear Model with <code>lm()</code> for Total Cholesterol</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(totchol <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> smoker <span class="sc">+</span> <span class="fu">factor</span>(educ), <span class="at">data =</span> smalldat)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(m1) <span class="sc">|&gt;</span> <span class="fu">select</span>(r.squared, adj.r.squared, sigma, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                     AIC, BIC, df, df.residual, nobs) <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(r.squared<span class="sc">:</span>sigma, <span class="at">decimals =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="fcraqswqzu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fcraqswqzu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fcraqswqzu thead, #fcraqswqzu tbody, #fcraqswqzu tfoot, #fcraqswqzu tr, #fcraqswqzu td, #fcraqswqzu th {
  border-style: none;
}

#fcraqswqzu p {
  margin: 0;
  padding: 0;
}

#fcraqswqzu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fcraqswqzu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fcraqswqzu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fcraqswqzu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fcraqswqzu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fcraqswqzu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fcraqswqzu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fcraqswqzu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fcraqswqzu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fcraqswqzu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fcraqswqzu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fcraqswqzu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fcraqswqzu .gt_spanner_row {
  border-bottom-style: hidden;
}

#fcraqswqzu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fcraqswqzu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fcraqswqzu .gt_from_md > :first-child {
  margin-top: 0;
}

#fcraqswqzu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fcraqswqzu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fcraqswqzu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fcraqswqzu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fcraqswqzu .gt_row_group_first td {
  border-top-width: 2px;
}

#fcraqswqzu .gt_row_group_first th {
  border-top-width: 2px;
}

#fcraqswqzu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fcraqswqzu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fcraqswqzu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fcraqswqzu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fcraqswqzu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fcraqswqzu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fcraqswqzu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fcraqswqzu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fcraqswqzu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fcraqswqzu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fcraqswqzu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fcraqswqzu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fcraqswqzu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fcraqswqzu .gt_left {
  text-align: left;
}

#fcraqswqzu .gt_center {
  text-align: center;
}

#fcraqswqzu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fcraqswqzu .gt_font_normal {
  font-weight: normal;
}

#fcraqswqzu .gt_font_bold {
  font-weight: bold;
}

#fcraqswqzu .gt_font_italic {
  font-style: italic;
}

#fcraqswqzu .gt_super {
  font-size: 65%;
}

#fcraqswqzu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fcraqswqzu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fcraqswqzu .gt_indent_1 {
  text-indent: 5px;
}

#fcraqswqzu .gt_indent_2 {
  text-indent: 10px;
}

#fcraqswqzu .gt_indent_3 {
  text-indent: 15px;
}

#fcraqswqzu .gt_indent_4 {
  text-indent: 20px;
}

#fcraqswqzu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="r.squared">r.squared</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="adj.r.squared">adj.r.squared</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sigma">sigma</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="AIC">AIC</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="BIC">BIC</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df.residual">df.residual</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="nobs">nobs</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="r.squared" class="gt_row gt_right">0.078</td>
<td headers="adj.r.squared" class="gt_row gt_right">0.039</td>
<td headers="sigma" class="gt_row gt_right">37.998</td>
<td headers="AIC" class="gt_row gt_right">1525.772</td>
<td headers="BIC" class="gt_row gt_right">1549.857</td>
<td headers="df" class="gt_row gt_right">6</td>
<td headers="df.residual" class="gt_row gt_right">143</td>
<td headers="nobs" class="gt_row gt_right">150</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="jytgszhqxh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jytgszhqxh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jytgszhqxh thead, #jytgszhqxh tbody, #jytgszhqxh tfoot, #jytgszhqxh tr, #jytgszhqxh td, #jytgszhqxh th {
  border-style: none;
}

#jytgszhqxh p {
  margin: 0;
  padding: 0;
}

#jytgszhqxh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jytgszhqxh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jytgszhqxh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jytgszhqxh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jytgszhqxh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jytgszhqxh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jytgszhqxh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jytgszhqxh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jytgszhqxh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jytgszhqxh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jytgszhqxh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jytgszhqxh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jytgszhqxh .gt_spanner_row {
  border-bottom-style: hidden;
}

#jytgszhqxh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jytgszhqxh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jytgszhqxh .gt_from_md > :first-child {
  margin-top: 0;
}

#jytgszhqxh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jytgszhqxh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jytgszhqxh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jytgszhqxh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jytgszhqxh .gt_row_group_first td {
  border-top-width: 2px;
}

#jytgszhqxh .gt_row_group_first th {
  border-top-width: 2px;
}

#jytgszhqxh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jytgszhqxh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jytgszhqxh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jytgszhqxh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jytgszhqxh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jytgszhqxh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jytgszhqxh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jytgszhqxh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jytgszhqxh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jytgszhqxh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jytgszhqxh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jytgszhqxh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jytgszhqxh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jytgszhqxh .gt_left {
  text-align: left;
}

#jytgszhqxh .gt_center {
  text-align: center;
}

#jytgszhqxh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jytgszhqxh .gt_font_normal {
  font-weight: normal;
}

#jytgszhqxh .gt_font_bold {
  font-weight: bold;
}

#jytgszhqxh .gt_font_italic {
  font-style: italic;
}

#jytgszhqxh .gt_super {
  font-size: 65%;
}

#jytgszhqxh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jytgszhqxh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jytgszhqxh .gt_indent_1 {
  text-indent: 5px;
}

#jytgszhqxh .gt_indent_2 {
  text-indent: 10px;
}

#jytgszhqxh .gt_indent_3 {
  text-indent: 15px;
}

#jytgszhqxh .gt_indent_4 {
  text-indent: 20px;
}

#jytgszhqxh .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.low">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.high">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">167.153</td>
<td headers="std.error" class="gt_row gt_right">21.639</td>
<td headers="statistic" class="gt_row gt_right">7.725</td>
<td headers="p.value" class="gt_row gt_right">0.000</td>
<td headers="conf.low" class="gt_row gt_right">124.380</td>
<td headers="conf.high" class="gt_row gt_right">209.926</td></tr>
    <tr><td headers="term" class="gt_row gt_left">age</td>
<td headers="estimate" class="gt_row gt_right">1.248</td>
<td headers="std.error" class="gt_row gt_right">0.379</td>
<td headers="statistic" class="gt_row gt_right">3.296</td>
<td headers="p.value" class="gt_row gt_right">0.001</td>
<td headers="conf.low" class="gt_row gt_right">0.500</td>
<td headers="conf.high" class="gt_row gt_right">1.996</td></tr>
    <tr><td headers="term" class="gt_row gt_left">sexM</td>
<td headers="estimate" class="gt_row gt_right">3.153</td>
<td headers="std.error" class="gt_row gt_right">6.515</td>
<td headers="statistic" class="gt_row gt_right">0.484</td>
<td headers="p.value" class="gt_row gt_right">0.629</td>
<td headers="conf.low" class="gt_row gt_right">−9.725</td>
<td headers="conf.high" class="gt_row gt_right">16.030</td></tr>
    <tr><td headers="term" class="gt_row gt_left">smoker</td>
<td headers="estimate" class="gt_row gt_right">3.462</td>
<td headers="std.error" class="gt_row gt_right">6.526</td>
<td headers="statistic" class="gt_row gt_right">0.531</td>
<td headers="p.value" class="gt_row gt_right">0.597</td>
<td headers="conf.low" class="gt_row gt_right">−9.438</td>
<td headers="conf.high" class="gt_row gt_right">16.363</td></tr>
    <tr><td headers="term" class="gt_row gt_left">factor(educ)2_Middle</td>
<td headers="estimate" class="gt_row gt_right">11.330</td>
<td headers="std.error" class="gt_row gt_right">7.740</td>
<td headers="statistic" class="gt_row gt_right">1.464</td>
<td headers="p.value" class="gt_row gt_right">0.145</td>
<td headers="conf.low" class="gt_row gt_right">−3.970</td>
<td headers="conf.high" class="gt_row gt_right">26.631</td></tr>
    <tr><td headers="term" class="gt_row gt_left">factor(educ)3_High</td>
<td headers="estimate" class="gt_row gt_right">−2.202</td>
<td headers="std.error" class="gt_row gt_right">9.426</td>
<td headers="statistic" class="gt_row gt_right">−0.234</td>
<td headers="p.value" class="gt_row gt_right">0.816</td>
<td headers="conf.low" class="gt_row gt_right">−20.834</td>
<td headers="conf.high" class="gt_row gt_right">16.431</td></tr>
    <tr><td headers="term" class="gt_row gt_left">factor(educ)4_VHigh</td>
<td headers="estimate" class="gt_row gt_right">11.743</td>
<td headers="std.error" class="gt_row gt_right">9.925</td>
<td headers="statistic" class="gt_row gt_right">1.183</td>
<td headers="p.value" class="gt_row gt_right">0.239</td>
<td headers="conf.low" class="gt_row gt_right">−7.875</td>
<td headers="conf.high" class="gt_row gt_right">31.361</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="fitting-a-bayesian-linear-model" class="level2" data-number="33.5">
<h2 data-number="33.5" class="anchored" data-anchor-id="fitting-a-bayesian-linear-model"><span class="header-section-number">33.5</span> Fitting a Bayesian Linear Model</h2>
<p>Can we fit a model for the same data using a Bayesian approach?</p>
<p>Yes, we can, for instance using the <code>stan_glm()</code> function from the <code>rstanarm</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">43211234</span>) <span class="co"># best to set a random seed first</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(totchol <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> smoker <span class="sc">+</span> <span class="fu">factor</span>(educ), </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> smalldat, <span class="at">refresh =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here the <code>refresh = 0</code> parameter stops the machine from printing out each of the updates it does while sampling, which is not generally something I need to look at. Here’s what’s placed in the <code>m2</code> object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>m2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      totchol ~ age + sex + smoker + factor(educ)
 observations: 150
 predictors:   7
------
                     Median MAD_SD
(Intercept)          166.3   21.5 
age                    1.3    0.4 
sexM                   3.1    6.5 
smoker                 3.8    6.3 
factor(educ)2_Middle  11.4    7.7 
factor(educ)3_High    -2.4    9.5 
factor(educ)4_VHigh   11.7    9.9 

Auxiliary parameter(s):
      Median MAD_SD
sigma 38.1    2.4  

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
</div>
<ul>
<li>The first few lines specify the fitting process.</li>
<li>Next, for each coefficient, we find the median value from the posterior distribution, and the MAD_SD value, which is an indicator of variation derived from the estimated posterior distribution of the parameters, and is used as a standard error in what follows.</li>
<li>Finally, we see the estimated root mean squared error (residual standard deviation) <code>sigma</code>, again estimated with the median of the <code>sigma</code> values in the posterior distribution.</li>
</ul>
<p>Using the <code>summary()</code> function provides some additional information about the parameter estimates, but mostly some convergence diagnostics for the Markov Chain Monte Carlo procedure that the <code>rstanarm</code> package used to build the estimates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Info:
 function:     stan_glm
 family:       gaussian [identity]
 formula:      totchol ~ age + sex + smoker + factor(educ)
 algorithm:    sampling
 sample:       4000 (posterior sample size)
 priors:       see help('prior_summary')
 observations: 150
 predictors:   7

Estimates:
                       mean   sd    10%   50%   90%
(Intercept)          167.0   21.8 139.6 166.3 195.3
age                    1.2    0.4   0.8   1.3   1.7
sexM                   3.1    6.7  -5.2   3.1  11.5
smoker                 3.7    6.4  -4.5   3.8  12.0
factor(educ)2_Middle  11.3    7.9   1.2  11.4  21.3
factor(educ)3_High    -2.2    9.6 -14.3  -2.4  10.2
factor(educ)4_VHigh   11.8   10.0  -1.1  11.7  24.8
sigma                 38.2    2.3  35.4  38.1  41.3

Fit Diagnostics:
           mean   sd    10%   50%   90%
mean_PPD 236.8    4.4 231.0 236.7 242.4

The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).

MCMC diagnostics
                     mcse Rhat n_eff
(Intercept)          0.4  1.0  3208 
age                  0.0  1.0  3858 
sexM                 0.1  1.0  4725 
smoker               0.1  1.0  3941 
factor(educ)2_Middle 0.1  1.0  3535 
factor(educ)3_High   0.2  1.0  3947 
factor(educ)4_VHigh  0.2  1.0  3980 
sigma                0.0  1.0  4159 
mean_PPD             0.1  1.0  4324 
log-posterior        0.0  1.0  1773 

For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</code></pre>
</div>
</div>
<section id="extracting-the-posterior" class="level3" data-number="33.5.1">
<h3 data-number="33.5.1" class="anchored" data-anchor-id="extracting-the-posterior"><span class="header-section-number">33.5.1</span> Extracting the Posterior</h3>
<p>Let’s extract the coefficients of our model, using the <code>get_parameters()</code> function from the <code>insight</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>posteriors <span class="ot">&lt;-</span> <span class="fu">get_parameters</span>(m2)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(posteriors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)       age      sexM      smoker factor(educ)2_Middle
1    147.0370 1.4540875  2.104415  15.0169219           19.5402757
2    190.0645 0.9457021  6.863091 -12.4867763            8.4980822
3    136.3315 1.6844863  7.994193   9.1766741           24.8636150
4    169.9511 1.1722918  3.785779   0.5804774            6.5798777
5    141.0931 1.5370710  7.006277  12.6397405           17.0076561
6    153.6542 1.3556864 22.009667  11.4591142           -0.9136777
  factor(educ)3_High factor(educ)4_VHigh
1           5.941676            4.100910
2          -9.449067           20.836287
3           9.972711           12.456202
4          -7.890619           16.454040
5           7.221881           -9.123619
6          -4.333041            7.401950</code></pre>
</div>
</div>
<p>In all, we have 4000 observations of this posterior distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(posteriors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4000</code></pre>
</div>
</div>
<p>Let’s visualize the posterior distribution of our parameter for <code>age</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(posteriors, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"dodgerblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bayes_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This distribution describes the probability (on the vertical axis) of various <code>age</code> effects (shown on the horizontal axis). Most of the distribution is between 0.5 and 2, with the peak being around 1.25.</p>
<p>Remember that our <code>m1</code> fit with <code>lm()</code> had an estimated <span class="math inline">\(\beta\)</span> for <code>age</code> of 1.248, so, as is often the case, there is not a lot of difference between the two models in terms of the estimates they make.</p>
<p>Here’s the mean and median of the <code>age</code> effect, across our 4000 simulations from the posterior distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(posteriors<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.249122</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(posteriors<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.251402</code></pre>
</div>
</div>
<p>Again, these are very close to what we obtained from least squares estimation.</p>
<p>Another option is to take the mode (peak) of the posterior distribution, and this is called the maximum a posteriori (MAP) estimate:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_estimate</span>(posteriors<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MAP Estimate

Parameter | MAP_Estimate
------------------------
x         |         1.26</code></pre>
</div>
</div>
<p>Adding these estimates to our plot, we can see that they are all on top of each other:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(posteriors, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"dodgerblue"</span>) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The mean in yellow</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(posteriors<span class="sc">$</span>age), <span class="at">color =</span> <span class="st">"yellow"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The median in red</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(posteriors<span class="sc">$</span>age), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The MAP in purple</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">as.numeric</span>(<span class="fu">map_estimate</span>(posteriors<span class="sc">$</span>age)), <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bayes_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="describing-uncertainty" class="level3" data-number="33.5.2">
<h3 data-number="33.5.2" class="anchored" data-anchor-id="describing-uncertainty"><span class="header-section-number">33.5.2</span> Describing Uncertainty</h3>
<p>We might describe the range of estimates for the <code>age</code> effect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(posteriors<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.03663079  2.63023158</code></pre>
</div>
</div>
<p>Instead of showing the whole range, we usually compute the highest density interval at some percentage level, for instance a 95% credible interval which shows the range containing the 95% most probable effect values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hdi</span>(posteriors<span class="sc">$</span>age, <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% HDI: [0.50, 1.98]</code></pre>
</div>
</div>
<p>So we conclude that the <code>age</code> effect has a 95% chance of falling within the [0.50, 1.98] range.</p>
</section>
<section id="visualizing-the-coefficients-and-credible-intervals" class="level3" data-number="33.5.3">
<h3 data-number="33.5.3" class="anchored" data-anchor-id="visualizing-the-coefficients-and-credible-intervals"><span class="header-section-number">33.5.3</span> Visualizing the Coefficients and Credible Intervals</h3>
<p>Here is a plot of the coefficients and parameters estimated in <code>m2</code>, along with credible intervals for their values. The inner interval (shaded region) here uses the default choice of 50%, and the outer interval (lines) uses a non-default choice of 95% (90% is the default choice here, as it turns out.) The point estimate shown here is the median of the posterior distribution, which is the default.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m2, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">prob_outer =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bayes_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="summarizing-the-posterior-distribution" class="level2" data-number="33.6">
<h2 data-number="33.6" class="anchored" data-anchor-id="summarizing-the-posterior-distribution"><span class="header-section-number">33.6</span> Summarizing the Posterior Distribution</h2>
<p>A more detailed set of summaries for the posterior distribution can be obtained from the <code>describe_posterior()</code> function from the <code>bayestestR</code> package.</p>
<p>A brief tutorial on what is shown here is available at <a href="https://easystats.github.io/bayestestR/articles/bayestestR.html" class="uri">https://easystats.github.io/bayestestR/articles/bayestestR.html</a> and <a href="https://easystats.github.io/bayestestR/articles/example1.html" class="uri">https://easystats.github.io/bayestestR/articles/example1.html</a> and this is the source for much of what I’ve built in this little chapter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_posterior</span>(m2) <span class="sc">|&gt;</span> <span class="fu">print_md</span>(<span class="at">decimals =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Summary of Posterior Distribution</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 7%">
<col style="width: 18%">
<col style="width: 7%">
<col style="width: 15%">
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Median</th>
<th style="text-align: left;">95% CI</th>
<th style="text-align: right;">pd</th>
<th style="text-align: left;">ROPE</th>
<th style="text-align: right;">% in ROPE</th>
<th style="text-align: left;">Rhat</th>
<th style="text-align: left;">ESS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: left;">166.28</td>
<td style="text-align: left;">[124.14, 209.25]</td>
<td style="text-align: right;">100%</td>
<td style="text-align: left;">[-3.88, 3.88]</td>
<td style="text-align: right;">0%</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">3208.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: left;">1.25</td>
<td style="text-align: left;">[ 0.51, 1.99]</td>
<td style="text-align: right;">99.95%</td>
<td style="text-align: left;">[-3.88, 3.88]</td>
<td style="text-align: right;">100%</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">3858.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: left;">3.07</td>
<td style="text-align: left;">[ -9.93, 16.46]</td>
<td style="text-align: right;">68.20%</td>
<td style="text-align: left;">[-3.88, 3.88]</td>
<td style="text-align: right;">42.32%</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">4725.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">smoker</td>
<td style="text-align: left;">3.75</td>
<td style="text-align: left;">[ -9.12, 16.17]</td>
<td style="text-align: right;">71.67%</td>
<td style="text-align: left;">[-3.88, 3.88]</td>
<td style="text-align: right;">41.61%</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">3941.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">factor(educ)2_Middle</td>
<td style="text-align: left;">11.39</td>
<td style="text-align: left;">[ -4.42, 26.57]</td>
<td style="text-align: right;">92.38%</td>
<td style="text-align: left;">[-3.88, 3.88]</td>
<td style="text-align: right;">14.45%</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">3535.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">factor(educ)3_High</td>
<td style="text-align: left;">-2.42</td>
<td style="text-align: left;">[-20.30, 16.54]</td>
<td style="text-align: right;">59.70%</td>
<td style="text-align: left;">[-3.88, 3.88]</td>
<td style="text-align: right;">31.45%</td>
<td style="text-align: left;">1.000</td>
<td style="text-align: left;">3947.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">factor(educ)4_VHigh</td>
<td style="text-align: left;">11.70</td>
<td style="text-align: left;">[ -7.24, 31.59]</td>
<td style="text-align: right;">88.00%</td>
<td style="text-align: left;">[-3.88, 3.88]</td>
<td style="text-align: right;">16.58%</td>
<td style="text-align: left;">0.999</td>
<td style="text-align: left;">3980.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Let’s walk through all of this output.</p>
<section id="summarizing-the-parameter-values" class="level3" data-number="33.6.1">
<h3 data-number="33.6.1" class="anchored" data-anchor-id="summarizing-the-parameter-values"><span class="header-section-number">33.6.1</span> Summarizing the Parameter values</h3>
<p>For each parameter, we have:</p>
<ul>
<li>its estimated median across the posterior distribution</li>
<li>its 95% credible interval (highest density interval of values within the posterior distribution)</li>
</ul>
<p>as we’ve previously discussed.</p>
</section>
<section id="probability-of-direction-pd-estimates." class="level3" data-number="33.6.2">
<h3 data-number="33.6.2" class="anchored" data-anchor-id="probability-of-direction-pd-estimates."><span class="header-section-number">33.6.2</span> Probability of Direction (<code>pd</code>) estimates.</h3>
<p>The <code>pd</code> estimate helps us understand whether each effect is positive or negative. For instance, regarding <code>age</code>, we see the proportion of the posterior that is in the direction of the effect’s point estimate, no matter what the “size” of the effect is, will be as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>n_positive <span class="ot">&lt;-</span> posteriors <span class="sc">|&gt;</span> <span class="fu">filter</span>(age <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> <span class="fu">nrow</span>()</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">*</span> n_positive <span class="sc">/</span> <span class="fu">nrow</span>(posteriors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 99.95</code></pre>
</div>
</div>
<p>So we see that the effect of <code>age</code> is positive with a probability of 99.95%, and this is called the <strong>probability of direction</strong> and abbreviated <strong>pd</strong>.</p>
<p>We can also calculate this with</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p_direction</span>(posteriors<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Probability of Direction

Parameter |     pd
------------------
Posterior | 99.95%</code></pre>
</div>
</div>
<p>As it turns out, this <code>pd</code> index is usually highly correlated with the p-value from our <code>lm()</code> fit for <code>age</code>. We could almost roughly infer the corresponding p-value with a simple transformation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fl">99.95</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>onesided_p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> pd <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>twosided_p <span class="ot">&lt;-</span> onesided_p <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>twosided_p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.001</code></pre>
</div>
</div>
<p>This implies that the <span class="math inline">\(p\)</span>-value for <code>age</code> in our <code>lm()</code> fit would be 0.001, and that is, in fact, what we got when we fit model <code>m1</code>.</p>
<p>The probability that each effect is in the direction shown by the point estimate is summarized in the <code>pd</code> column of our <code>describe_posterior()</code> results.</p>
</section>
<section id="the-rope-estimates" class="level3" data-number="33.6.3">
<h3 data-number="33.6.3" class="anchored" data-anchor-id="the-rope-estimates"><span class="header-section-number">33.6.3</span> The ROPE estimates</h3>
<p>Testing whether this distribution is different from 0 doesn’t make sense, as 0 is a single value (and the probability that any distribution is different from a single value is infinite). However, one way to assess significance could be to define an area around 0, which will consider as practically equivalent to zero (i.e., absence of, or a negligible, effect). This is called the Region of Practical Equivalence (ROPE).</p>
<p>The default (semi-objective) way of defining the ROPE is to use the tenth (1/10) of the standard deviation (SD) of the outcome variable <code>totchol</code>. This is sometimes considered a “negligible” effect size.</p>
<p>In our case, <code>totchol</code> has a standard deviation of 38.8, so the ROPE range is approximately (-3.88, 3.88), or somewhat more precisely:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rope_range</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.876809  3.876809</code></pre>
</div>
</div>
<p>So we then compute the <strong>percentage in ROPE</strong> as the percentage of the posterior distribution that falls within this ROPE range. When most of the posterior distribution does not overlap with ROPE, we might conclude that the effect is important enough to be noted.</p>
<p>In our case, 100% of the <code>age</code> effects are in the ROPE, so that’s not really evidence of an important effect.</p>
<p>For <code>smoker</code>, though, only 42% of the effects are in the ROPE, so that’s indicative of a somewhat more substantial effect, but we’d only get really excited if a much smaller fraction, say 1%, 5% or maybe 10% were in the ROPE.</p>
</section>
<section id="convergence-diagnostics" class="level3" data-number="33.6.4">
<h3 data-number="33.6.4" class="anchored" data-anchor-id="convergence-diagnostics"><span class="header-section-number">33.6.4</span> Convergence Diagnostics</h3>
<p>The value of Rhat should, ideally, be 1 for each element of the model, and indicate how well the MCMC procedure converged. Generally, values of Rhat below 1.05 are good, values between 1.05 and 1.1 are OK, but values above 1.1 are too high. Here, as you can see, we don’t see any serious problems.</p>
<p>As for ESS, we’d like to see values of 1000 or more to ensure sufficiently stable estimates. Here, again, we’re OK.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(m2, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="srhdxitoln" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#srhdxitoln table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#srhdxitoln thead, #srhdxitoln tbody, #srhdxitoln tfoot, #srhdxitoln tr, #srhdxitoln td, #srhdxitoln th {
  border-style: none;
}

#srhdxitoln p {
  margin: 0;
  padding: 0;
}

#srhdxitoln .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#srhdxitoln .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#srhdxitoln .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#srhdxitoln .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#srhdxitoln .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#srhdxitoln .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#srhdxitoln .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#srhdxitoln .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#srhdxitoln .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#srhdxitoln .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#srhdxitoln .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#srhdxitoln .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#srhdxitoln .gt_spanner_row {
  border-bottom-style: hidden;
}

#srhdxitoln .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#srhdxitoln .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#srhdxitoln .gt_from_md > :first-child {
  margin-top: 0;
}

#srhdxitoln .gt_from_md > :last-child {
  margin-bottom: 0;
}

#srhdxitoln .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#srhdxitoln .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#srhdxitoln .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#srhdxitoln .gt_row_group_first td {
  border-top-width: 2px;
}

#srhdxitoln .gt_row_group_first th {
  border-top-width: 2px;
}

#srhdxitoln .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#srhdxitoln .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#srhdxitoln .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#srhdxitoln .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#srhdxitoln .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#srhdxitoln .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#srhdxitoln .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#srhdxitoln .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#srhdxitoln .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#srhdxitoln .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#srhdxitoln .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#srhdxitoln .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#srhdxitoln .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#srhdxitoln .gt_left {
  text-align: left;
}

#srhdxitoln .gt_center {
  text-align: center;
}

#srhdxitoln .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#srhdxitoln .gt_font_normal {
  font-weight: normal;
}

#srhdxitoln .gt_font_bold {
  font-weight: bold;
}

#srhdxitoln .gt_font_italic {
  font-style: italic;
}

#srhdxitoln .gt_super {
  font-size: 65%;
}

#srhdxitoln .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#srhdxitoln .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#srhdxitoln .gt_indent_1 {
  text-indent: 5px;
}

#srhdxitoln .gt_indent_2 {
  text-indent: 10px;
}

#srhdxitoln .gt_indent_3 {
  text-indent: 15px;
}

#srhdxitoln .gt_indent_4 {
  text-indent: 20px;
}

#srhdxitoln .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.low">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.high">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">166.284</td>
<td headers="std.error" class="gt_row gt_right">21.546</td>
<td headers="conf.low" class="gt_row gt_right">124.137</td>
<td headers="conf.high" class="gt_row gt_right">209.245</td></tr>
    <tr><td headers="term" class="gt_row gt_left">age</td>
<td headers="estimate" class="gt_row gt_right">1.251</td>
<td headers="std.error" class="gt_row gt_right">0.374</td>
<td headers="conf.low" class="gt_row gt_right">0.511</td>
<td headers="conf.high" class="gt_row gt_right">1.992</td></tr>
    <tr><td headers="term" class="gt_row gt_left">sexM</td>
<td headers="estimate" class="gt_row gt_right">3.074</td>
<td headers="std.error" class="gt_row gt_right">6.538</td>
<td headers="conf.low" class="gt_row gt_right">−9.929</td>
<td headers="conf.high" class="gt_row gt_right">16.461</td></tr>
    <tr><td headers="term" class="gt_row gt_left">smoker</td>
<td headers="estimate" class="gt_row gt_right">3.753</td>
<td headers="std.error" class="gt_row gt_right">6.328</td>
<td headers="conf.low" class="gt_row gt_right">−9.119</td>
<td headers="conf.high" class="gt_row gt_right">16.175</td></tr>
    <tr><td headers="term" class="gt_row gt_left">factor(educ)2_Middle</td>
<td headers="estimate" class="gt_row gt_right">11.388</td>
<td headers="std.error" class="gt_row gt_right">7.705</td>
<td headers="conf.low" class="gt_row gt_right">−4.423</td>
<td headers="conf.high" class="gt_row gt_right">26.572</td></tr>
    <tr><td headers="term" class="gt_row gt_left">factor(educ)3_High</td>
<td headers="estimate" class="gt_row gt_right">−2.421</td>
<td headers="std.error" class="gt_row gt_right">9.495</td>
<td headers="conf.low" class="gt_row gt_right">−20.296</td>
<td headers="conf.high" class="gt_row gt_right">16.541</td></tr>
    <tr><td headers="term" class="gt_row gt_left">factor(educ)4_VHigh</td>
<td headers="estimate" class="gt_row gt_right">11.702</td>
<td headers="std.error" class="gt_row gt_right">9.889</td>
<td headers="conf.low" class="gt_row gt_right">−7.241</td>
<td headers="conf.high" class="gt_row gt_right">31.592</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
</section>
<section id="summarizing-the-priors-used" class="level2" data-number="33.7">
<h2 data-number="33.7" class="anchored" data-anchor-id="summarizing-the-priors-used"><span class="header-section-number">33.7</span> Summarizing the Priors Used</h2>
<p>From the <code>bayestestR</code> package, we also have the <code>describe_prior()</code> and <code>print_md()</code> functions to get the following summary of the priors we have assumed. Since we didn’t specify anything about the priors in fitting model <code>m2</code>, we are looking at the default choices, which are weakly informative priors following Normal distributions. Details on the default prior choices can be found at <a href="https://mc-stan.org/rstanarm/articles/priors.html" class="uri">https://mc-stan.org/rstanarm/articles/priors.html</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_prior</span>(m2) <span class="sc">|&gt;</span> <span class="fu">print_md</span>(<span class="at">decimals =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Prior_Distribution</th>
<th style="text-align: right;">Prior_Location</th>
<th style="text-align: right;">Prior_Scale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">normal</td>
<td style="text-align: right;">236.78</td>
<td style="text-align: right;">96.92</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">normal</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">10.87</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">normal</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">195.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">smoker</td>
<td style="text-align: right;">normal</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">193.21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">factor(educ)2_Middle</td>
<td style="text-align: right;">normal</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">210.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">factor(educ)3_High</td>
<td style="text-align: right;">normal</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">273.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">factor(educ)4_VHigh</td>
<td style="text-align: right;">normal</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">284.16</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="graphical-posterior-predictive-checks" class="level2" data-number="33.8">
<h2 data-number="33.8" class="anchored" data-anchor-id="graphical-posterior-predictive-checks"><span class="header-section-number">33.8</span> Graphical Posterior Predictive Checks</h2>
<p>For more on these checks, visit <a href="https://mc-stan.org/rstanarm/articles/continuous.html#the-posterior-predictive-distribution-1" class="uri">https://mc-stan.org/rstanarm/articles/continuous.html#the-posterior-predictive-distribution-1</a>, for example.</p>
<p>Here’s the first plot which compares the distribution of the observed outcome <span class="math inline">\(y\)</span> (totchol) to several of the simulated data sets <span class="math inline">\(y_{rep}\)</span> from the posterior predictive distribution using the same predictor values as were used to fit the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(m2, <span class="at">plotfun =</span> <span class="st">"hist"</span>, <span class="at">nreps =</span> <span class="dv">5</span>, <span class="at">bins =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bayes_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The idea is that if the model is a good fit to the data we should be able to generate data <span class="math inline">\(y_{rep}\)</span> from the posterior predictive distribution that looks a lot like the observed data <span class="math inline">\(y\)</span>. That is, given <span class="math inline">\(y\)</span>, the <span class="math inline">\(y_{rep}\)</span> we generate should look plausible. We’d worry a bit if this plot showed histograms that were wildly different from one another.</p>
<p>Another useful plot (shown below) made using <code>pp_check</code> shows the distribution of a test quantity <span class="math inline">\(T(y_{rep})\)</span> compared to <span class="math inline">\(T(y)\)</span>, the value of the quantity in the observed data. I like this scatterplot version which allows us to look at where the simulations’ mean and standard deviation fall compared to what the observed <code>totchol</code> values show us.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(m2, <span class="at">plotfun =</span> <span class="st">"stat_2d"</span>, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"sd"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bayes_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that the cloud of simulated means and standard deviations has the observed statistics near its center, although perhaps the standard deviations are a bit higher than we might like to see, typically. Ideally, the dot would be right in the center of this cloud of simulated results.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./lasso.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">NEW!! A Few LASSO Ideas</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./bayes2.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">NEW!! Bayes and a Logistic Model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>